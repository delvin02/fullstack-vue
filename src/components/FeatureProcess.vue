<script setup>
import { FwbBadge } from 'flowbite-vue'

</script>
<template>
    <div>
        <div id="container" class="overflow-x-hidden relative">
            <div class="flex w-[300vw] snap-x snap-mandatory flex-nowrap">
                <svg viewBox="0 0 900 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M9.89998 6C9.43671 8.28224 7.41896 10 5 10C2.23858 10 0 7.76142 0 5C0 2.23858 2.23858 0 5 0C7.41896 0 9.43671 1.71776 9.89998 4H445.1C445.563 1.71776 447.581 0 450 0C452.419 0 454.437 1.71776 454.9 4H890.1C890.563 1.71776 892.581 0 895 0C897.761 0 900 2.23858 900 5C900 7.76142 897.761 10 895 10C892.581 10 890.563 8.28224 890.1 6H454.9C454.437 8.28224 452.419 10 450 10C447.581 10 445.563 8.28224 445.1 6H9.89998Z"
                        fill="#D9D9D9" />
                    <mask id="mask0_0_1" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="900"
                        height="10">
                        height="10">
                        <path
                            d="M9.89998 6C9.43671 8.28224 7.41896 10 5 10C2.23858 10 0 7.76142 0 5C0 2.23858 2.23858 0 5 0C7.41896 0 9.43671 1.71776 9.89998 4H445.1C445.563 1.71776 447.581 0 450 0C452.419 0 454.437 1.71776 454.9 4H890.1C890.563 1.71776 892.581 0 895 0C897.761 0 900 2.23858 900 5C900 7.76142 897.761 10 895 10C892.581 10 890.563 8.28224 890.1 6H454.9C454.437 8.28224 452.419 10 450 10C447.581 10 445.563 8.28224 445.1 6H9.89998Z"
                            fill="#D9D9D9" />
                    </mask>
                    <g mask="url(#mask0_0_1)">
                        <rect class="mask" y="-49" height="99" fill="black" />
                    </g>
                </svg>
                <section class="snap-center w-full py-[20vw] px-[20vw] sec1 pin">
                    <div class="grid grid-cols-4 gap-5">
                        <div class="flex justify-center bg-yellow-300 items-center">
                            <h1 class="text-center text-5xl font-bold">Feature</h1>
                        </div>
                        <div class="col-span-3 bg-gray-200 p-10">
                            <h1 class="text-black text-5xl font-bold anim">Syncing Financial Data.</h1>

                            <div class="flex gap-3 anim mt-10">
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="snap-center w-full py-[20vw] px-[20vw] sec1 pin">
                    <div class="grid grid-cols-4 gap-5">
                        <div class="flex justify-center bg-yellow-300 items-center">
                            <h1 class="text-center text-5xl font-bold">Feature</h1>
                        </div>
                        <div class="col-span-3 bg-gray-200 p-10">
                            <h1 class="text-black text-5xl font-bold anim">Eliminate Double Handling.</h1>

                            <div class="flex gap-3 anim mt-10">
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="snap-center w-full py-[20vw] px-[20vw] sec1 pin">
                    <div class="grid grid-cols-4 gap-5">
                        <div class="flex justify-center bg-yellow-300 items-center">
                            <h1 class="text-center text-5xl font-bold">Feature</h1>
                        </div>
                        <div class="col-span-3 bg-gray-200 p-10">

                            <h1 class="text-black text-5xl font-bold anim">Automated Process.</h1>

                            <div class="flex gap-3 anim mt-10">
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                                <p class="text-black text-sm">Lorem ipsum dolor sit amet consectetur. Egestas euismod nec
                                    sit
                                    sed
                                    massa
                                    turpis in. Sit praesent arcu leo lectus pellentesque. Ornare elit orci morbi volutpat.
                                    Ut
                                    fermentum
                                    lorem morbi quis risus amet urna. Urna egestas lorem.</p>
                            </div>
                        </div>
                    </div>
                </section>

            </div>
        </div>

        <section class="bg-lightblue"></section>
    </div>
</template>

<script>
import gsap from 'gsap';
import ScrollTrigger from 'gsap/ScrollTrigger';

gsap.registerPlugin(ScrollTrigger);

export default {
    name: "FeatureProcess",
    mounted() {
        const container = this.$el.querySelector("#container");
        const sections = gsap.utils.toArray("#container section");
        const texts = gsap.utils.toArray(".anim");
        const mask = this.$el.querySelector(".mask");

        if (!container || sections.length === 0 || !mask) {
            console.error("Required elements not found");
            return;
        }

        let scrollTween = gsap.to(sections, {
            xPercent: -100 * (sections.length - 1),
            ease: "none",
            scrollTrigger: {
                trigger: "#container",
                container: window, // Use window as the container
                pin: true,
                scrub: 0.1,
                end: "+=3000",
                markers: false,
                start: 0,
                snap: {
                    snapTo: 1 / (sections.length - 1),
                    duration: 0.2,
                    delay: 0.1,
                },
                onUpdate: (self) => {
                    const progress = self.progress * 100;
                    console.log(progress);
                    gsap.to(mask, {
                        trigger: ".wrapper",
                        width: progress + "%",
                        start: "top left",
                        scrub: 1
                    });
                },
            },
        });


        sections.forEach((section, index) => {
            let text = section.querySelectorAll(".anim");
            if (text.length === 0) return;

            gsap.from(text, {
                y: 0,
                opacity: 0,
                duration: 2,
                ease: "elastic",
                stagger: 0.1,
                scrollTrigger: {
                    trigger: section,
                    container: window, // Use window as the container
                    start: "left center",
                    markers: false,
                    snap: {
                        snapTo: 1 / (sections.length - 1),
                        duration: 0.3,
                        delay: 0.1,
                        index: index,
                    },
                },
            });
        });
    },
};
</script>


<style scoped>
section {
    height: 100vh;
}

svg {
    position: absolute;
    top: 10em;
    left: 10vw;
    width: 80vw;
}

.mask {
    width: 0;
}
</style>